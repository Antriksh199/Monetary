@if(user)
{
    <div class="tab-container">
        <h3>Your all Investments at one place...</h3>
        <br>
        <mat-tab-group class="tab-group" (selectedIndexChange)="toggleIncome($event)" >
            @for( x of investmentCategoryTypes; track x.investmentCategory?.id)
            {
            <mat-tab class="tab" label="{{x.investmentCategory?.name}}">
                </mat-tab>
            }
            </mat-tab-group>
                @if(filteredInvestments.length > 0)
                {
                <div  class="outer-container">
                    <br>
                    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8" multiTemplateDataRows>
        
                        <ng-container matColumnDef="type">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="type"> Type </th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.investmentType?.name}} </td>
                          </ng-container>
    
                          <ng-container matColumnDef="investedOn">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="investedOn"> Invested On </th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.investedOn | date:'dd-MMM-yy': 'Asia/Kolkata' }} </td>
                          </ng-container>
    
                          <ng-container matColumnDef="value" >
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="value"> Amount </th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.value | currency:'INR':'symbol':'1.2-2':'en-IN' }} </td>
                        </ng-container>
    
                        <ng-container matColumnDef="invested">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header="invested"> Status </th>
                            <td mat-cell *matCellDef="let investment">{{ investment.invested ? 'Paid' : 'Pending' }} </td>
                          </ng-container>
                          
                        <ng-container matColumnDef="investedTo">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header="investedTo"> Invested To </th>
                            <td mat-cell *matCellDef="let investment">{{ investment.investedTo }} </td>
                        </ng-container>
    
                        <ng-container matColumnDef="investedVia" >
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Invested Via </th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.investedVia.paymentMethod.name }} </td>
                        </ng-container>
                          <!-- Frequency-->
                        <ng-container matColumnDef="frequency" >
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Frequency </th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.frequency?.name }} </td>
                        </ng-container>
        
                        <!-- Created Date-->
                        <ng-container matColumnDef="createdDate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="createdDate"> Added On</th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.createdDate | date:"dd-MMM-yy hh:mm a": 'Asia/Kolkata' }} </td>
                        </ng-container>
        
                        <!-- Created By-->
                        <ng-container matColumnDef="createdBy">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="createdBy"> Added By</th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.createdBy }} </td>
                        </ng-container>
        
                         <!-- Modified Date-->
                         <ng-container matColumnDef="modifiedDate">
                            <th mat-header-cell *matHeaderCellDef  mat-sort-header="modifiedDate"> Modified On</th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.modifiedDate| date:"dd-MMM-yy hh:mm a":'Asia/Kolkata' }} </td>
                        </ng-container>
        
                        <!-- Modified By-->
                        <ng-container matColumnDef="modifiedBy">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header="modifiedBy"> Modified By</th>
                            <td mat-cell *matCellDef="let investment"> {{ investment.modifiedBy }} </td>
                        </ng-container>
        
        
                         <!-- Table Headers & Rows -->
                        <tr mat-header-row *matHeaderRowDef="tableColumns"></tr>
                        <tr mat-row *matRowDef="let investment; let i=index; columns: tableColumns" 
                        (contextmenu)="onRightClick($event, investment)"></tr>
                    </table>
                </div>
                }
                @else {
                <br>
                <div class="outer-container"><h2>You don't have any Investment in this category !</h2></div>
                }
        <div style="visibility: hidden; position: fixed"
            [style.left]="contextMenuPosition.x"
            [style.top]="contextMenuPosition.y"
            [matMenuTriggerFor]="contextMenu">
        </div>
        
                <mat-menu #contextMenu="matMenu">
                    <ng-template matMenuContent let-investment="investment">
                    <button mat-menu-item (click)="OnView(editRow)">View Investment</button>
                    <button mat-menu-item (click)="OnEdit(editRow)">Edit</button>
                    <button mat-menu-item (click)="OnDelete(editRow)">Delete</button>
                </ng-template>
                </mat-menu>
        </div>
}

@else 
{
    <h1>You are not authorized to view this page.</h1>
}

    
    